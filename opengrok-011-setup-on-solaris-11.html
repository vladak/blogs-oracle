<html><body>
<head>
            <title>OpenGrok 0.11 setup on Solaris 11 | Oracle Czech techie's adventures Blog</title>
<meta name="publish_date" content="2012-02-09 09:01:45">
</head>
                                                                    <p>OpenGrok 0.11 has been just released (see <a href="http://blogs.oracle.com/taz/entry/opengrok_0_11">Lubos' post</a> with release notes). This is nice version number coincidence to try it on Solaris 11.<br/>In case you are wondering what is OpenGrok, it is blindigly fast source code search and cross reference engine accessible over web.<br/>It is written in Java. It is also behind the source code browser on <a href="http://src.opensolaris.org">src.opensolaris.org</a>, albeit running older version.<br/>For more information about the project take a look at its <a href="http://hub.opensolaris.org/bin/view/Project+opengrok/">project page</a>.</p><p>Now, how to get OpenGrok running for your source code base on Solaris 11. I will illustrate this on source code coming from three different Source Code Management systems (for complete support see <a href="http://hub.opensolaris.org/bin/view/Project+opengrok/Repositories">the full list</a>).<br/>The complete setup on freshly installed Solaris 11 has 6 main steps:</p><br/><ol><li>Install pre-requisities first:<br/><ol><li>install couple of Source Code Management systems (depends on your needs):<ul><li>install Mercurial:<pre>    pkg install developer/versioning/mercurial</pre></li><li>install CVS<pre>    pkg install developer/versioning/cvs</pre></li><li>git<pre>    pkg install developer/versioning/git</pre></li></ul><li>download, compile and install exuberant ctags:<pre>pkg install developer/gcc-45<br/>pkg install system/header<br/>wget http://prdownloads.sourceforge.net/ctags/ctags-5.8.tar.gz<br/>tar xfz ctags-5.8.tar.gz<br/>cd ctags-5.8<br/>./configure && make && make install</pre></li><li>install Tomcat6:<pre>  pkg install web/java-servlet/tomcat</pre></li><br/></ol><br/></li><li><br/>Now download and install OpenGrok package<!-- (works fine with HTTP proxy specified via <tt>http_proxy</tt> environment variable) -->:<pre>location=http://hub.opensolaris.org/bin/download/Project+opengrok/files/<br/>pkgadd -d &#36;location/OSOLopengrok-0.11.pkg OSOLopengrok</pre><br/></li><li><br/>Mirror some source code as <tt>webservd</tt> user (note that OpenGrok by itself does not synchronize or mirror source code, this has to be done separately):<pre>cd /var/opengrok/src/<br/>cvs -d anonymous@cvs.openssl.org:/openssl-cvs co -rOpenSSL_1_0_0-stable openssl<br/>hg clone ssh://anon@hg.opensolaris.org/hg/opengrok/trunk opengrok-dev<br/>git clone http://git.samba.org/samba.git</pre><ul>Run the following first (as <tt>root</tt>) to make sure history indexing does not prompt to confirm the identify when consulting with remote repositories (CVS):<pre><!--<br/># if the server is behind proxy:<br/>git config --global http.proxy &#36;http_proxy<br/>cat << EOF >> /etc/ssh/ssh_config<br/>Host cvs.openssl.org<br/>  Hostname cvs.openssl.org<br/>  ProxyCommand /usr/bin/nc -X connect -x &#36;http_proxy:80 %h %p<br/>EOF<br/>cat << EOF >> /.hgrc<br/>[http_proxy]<br/>host=emeacache.uk.oracle.com:80<br/>EOF --><br/># store the pubkeys<br/>ssh-keyscan -t rsa,dsa cvs.openssl.org >> /etc/ssh/known_hosts<br/>ssh-keyscan -t rsa,dsa hg.opensolaris.org >> /etc/ssh/known_hosts</pre></ul><br/></li><li><br/>Deploy and start the web application (as <tt>root</tt>):<pre>EXUBERANT_CTAGS=/usr/local/bin/ctags &#92;<br/>    /usr/opengrok/bin/OpenGrok deploy && &#92;<br/>    svcadm enable tomcat6</pre><br/></li><li><br/>Index the source code and send the configuration to the running instance (as <tt>webservd</tt> user):<pre>EXUBERANT_CTAGS=/usr/local/bin/ctags &#92;<br/>   /usr/opengrok/bin/OpenGrok index</pre><br/></li><li>enable the service (as <tt>root</tt>):<pre>svcadm enable opengrok</pre><br/></li><br/></ol><p>OpenGrok is now accessible at http://SERVER_HOSTNAME:8080/source/ (where <tt>SERVER_HOSTNAME</tt> is the hostname of the server on which the above setup was done).</p><p>Except for the part with ctags it is pretty streamlined and no brainer process. Hopefully the <tt>exuberant-ctags</tt> package will be available again from the standard Oracle pkg repositories.</p><p>And here is the result:</p><p><center><br/><a href="//cdn.app.compendium.com/uploads/user/e7c690e8-6ff9-102a-ac6d-e4aebca50425/f4a5b21d-66fa-4885-92bf-c4e81c06d916/Image/e3b0ba4f0ab4264cb142728f597c9821/opengrok_s11.png"><img src="opengrok_s11.png" height="384 width="512"><br/></a><br/></center></p>
</body></html>
