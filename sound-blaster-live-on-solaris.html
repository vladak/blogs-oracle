<html><body>
<head>
            <title>Sound Blaster Live! on Solaris | Oracle Czech techie's adventures Blog</title>
<meta name="publish_date" content="2007-03-27 07:47:50">
</head>
                                                                    <p>During stressful days of <a href="http://src.opensolaris.org/source/xref/onnv/onnv-gate/usr/src/lib/libmd/">libmd</a> backport to <a href="http://www.sun.com/software/solaris/get.jsp">Solaris 10</a> update 4 I managed to break my <a href="http://en.wikipedia.org/wiki/IPod_mini">iPod mini</a><br/>by sliding on my chair backwards and running to get next coffee cup. (The catch was that I still had my <a href="http://www.koss.com/koss/kossweb.nsf/p?openform&pc%5Ept%5EPORTAPRO%5EY">headphones</a> connected to the iPod on so the iPod fell down on the floor. It now only reports the unhappy face of Macintosh.)</p><p>Only after that I have realized how music is important for my day-to-day tasks. I cannot simply continue in the same pace as before without steady flow of <a href="http://www.couchrecords.com/">rhythm</a> into my ears.</p><p>Before buying <a href="http://www.apple.com/ipodnano/red/">another iPod</a> I wanted to get some interim relief. This is when I entered the not-so-happy world of <a href="http://src.opensolaris.org/source/xref/onnv/onnv-gate/usr/src/uts/common/io/audio/">Solaris audio drivers</a>. My workstation is <a href="http://www.trustedreviews.com/pcs/review/2005/10/28/Acer-Aspire-E300-7NB73/p1">Acer Aspire E300</a> which came with integrated TV card and whatnot but also with integrated sound card. The sound card is supported in Solaris but the level of noise coming from it was unbearable. (and I am no HiFi snob, listening mostly to 32kbps <a href="http://www.radioakropolis.cz/">radio Akropolis</a> streams)<br/>After some googling I have realized that there is a driver for <a href="http://www.amazon.com/Creative-Sound-Blaster-Live-SB0200/dp/B000IMDKEI">Sound Blaster Live! 5.1 PCI card</a> which I had in my Solaris test workstation at home. The driver was backported by JÃ¼rgen Keil (frequent OpenSolaris contributor) from <a href="http://www.netbsd.org">NetBSD</a> among <a href="http://www.tools.de/opensource/solaris/audio/">other drivers</a>.</p><p>The relevant part of <tt>prtconf -v</tt> output looks like this:</p><pre>            pci1102,8027 (driver not attached)<br/>                Hardware properties:<br/>                    name='assigned-addresses' type=int items=5<br/>                        value=81024810.00000000.00009400.00000000.00000020<br/>                    name='reg' type=int items=10<br/>                        value=00024800.00000000.00000000.00000000.00000000.01024<br/>810.00000000.00000000.00000000.00000020<br/>                    name='compatible' type=string items=7<br/>                        value='pci1102,2.1102.8027.7' + 'pci1102,2.1102.8027' + <br/>'pci1102,8027' + 'pci1102,2.7' + 'pci1102,2' + 'pciclass,040100' + 'pciclass,0401'<br/>                    name='model' type=string items=1<br/>                        value='Audio device'</pre><p>It's quite easy to get it working:</p><br/><ol><li>disable the on-board sound card in BIOS</li><li>get the sources and extract them<pre>  /usr/sfw/bin/wget http://www.tools.de/files/opensource/solaris/audio/beta/audio-1.9beta.tar.bz2<br/>  bzcat audio-1.9beta.tar.bz2 | tar -xf -</pre></li><li>compile (set the PATH if needed to get access to <tt>gcc</tt>/<tt>ar</tt>)<pre>  export PATH=/usr/bin:/usr/sbin:/usr/sfw/bin:/usr/sfw/sbin:/usr/ccs/bin<br/>  cd audio-1.9beta &amp;&amp; make</pre></li><li>install the driver (<tt>audioemu</tt>) and its dependency (<tt>audiohlp</tt>) on x86:<pre>  cp drv/emu/audioemu /platform/i86pc/kernel/drv<br/>  cp drv/emu/amd64/audioemu /platform/i86pc/kernel/drv/amd64<br/>  cp drv/emu/audioemu.conf /platform/i86pc/kernel/drv<br/>  cp misc/audiohlp /kernel/misc<br/>  cp misc/amd64/audiohlp /kernel/misc/amd64<br/>  cp misc/audiohlp.conf /kernel/misc</pre></li><li>attach the driver (see instructions in <tt>drv/emu/Makefile</tt>)<pre>add_drv -i '"pci1102,2" "pci1102,4"' audioemu</pre></li><li>reboot</li><br/></ol><p>Yes, I could have used the infrastructure provided in Makefiles to create the package and install<br/>it but I wanted to have minimalistic install and have just the things which are really needed.</p><p>After the reboot you should be able to play sound via e.g. xmms. (installed e.g. from <a href="http://www.blastwave.org">Blastwave</a>) Check for <tt>audioemu</tt> in <tt>modinfo(1M)</tt> output and <tt>dmesg(1M)</tt> output for error messages if something goes wrong.<br/>So far it has been working for me rather flawlessly. (no kernel panics ;))</p><p>During the search for the driver I have discovered number of complaints from the users trying OpenSolaris for the first time that their Sound Blaster Live! was not recognized.<br/>Looking into <a href="http://www.opensolaris.org/os/community/device_drivers/">Device drivers community</a> not much is going on about soundcard drivers.<br/><br/>I wonder how hard would it be to get the <tt>audioemu</tt> NetBSD-based driver into ON.. the CR number is <a href="http://bugs.opensolaris.org/view_bug.do?bug_id=6539690">6539690</a>.</p><p>2007-08-08 update: After <a href="http://www.opensolaris.org/jive/thread.jspa?threadID=36674&tstart=0">asking</a> on <a href="http://www.opensolaris.org/jive/forum.jspa?forumID=13">opensolaris-discuss</a> mailing list I have realized that there is<br/>a project underway which will deliver <a href="http://www.opensound.com/oss.html">OSS</a> into (Open)Solaris. Some info can be found in <a href="http://opensolaris.org/os/community/arc/caselog/2007/238/">PSARC/2007/238</a>, however <br/>there is no project page at <a href="http://www.opensolaris.org/os/projects/#all">opensolaris.org</a> (yet). Hopefully, RFE <a href="http://bugs.opensolaris.org/view_bug.do?bug_id=6539690">6539690</a><br/>will be closed after OSS integrates into <a href="http://www.opensolaris.org/os/community/on/">ONNV</a>.</p>
</body></html>
